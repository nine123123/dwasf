<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡∏ï‡∏±‡∏ß‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏õ‡∏•‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏õ‡πá‡∏ô PDF + ‡∏£‡∏ß‡∏° PDF</title>
  <meta name="description" content="‡πÅ‡∏õ‡∏•‡∏á‡∏£‡∏π‡∏õ/‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô PDF ‡πÅ‡∏•‡∏∞‡∏£‡∏ß‡∏° PDF ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÄ‡∏ï‡πá‡∏°‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö" />
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='0.9em' font-size='90'%3EüìÑ%3C/text%3E%3C/svg%3E" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-50 text-slate-900">
  <div id="root"></div>

  <script type="module">
    import React, { useCallback, useMemo, useRef, useState } from "https://esm.sh/react@18";
    import { createRoot } from "https://esm.sh/react-dom@18/client";
    import { jsPDF } from "https://esm.sh/jspdf@2.5.1";
    import { PDFDocument } from "https://esm.sh/pdf-lib@1.17.1";

    function bytesToBase64(bytes) {
      let binary = "";
      const len = bytes.byteLength || bytes.length;
      const arr = bytes instanceof Uint8Array ? bytes : new Uint8Array(bytes);
      for (let i = 0; i < len; i++) binary += String.fromCharCode(arr[i]);
      return btoa(binary);
    }

    function downloadBlob(blob, filename) {
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    }

    const ACCEPT = [
      "application/pdf",
      "image/*",
      "text/plain",
      "text/markdown",
      "text/csv",
      "text/html",
      "text/*",
    ].join(",");

    const niceBytes = n => {
      if (n == null) return "";
      const units = ["B", "KB", "MB", "GB"]; let i = 0; let v = n;
      while (v >= 1024 && i < units.length - 1) { v /= 1024; i++; }
      return \`\${v.toFixed(v < 10 && i > 0 ? 1 : 0)} \${units[i]}\`;
    };

    function App() {
      const [files, setFiles] = useState([]);
      const [converted, setConverted] = useState([]); // {name, blob, size}
      const [mergeList, setMergeList] = useState([]); // {type: 'converted'|'uploaded', idx|fileIndex}
      const [busy, setBusy] = useState(false);
      const [log, setLog] = useState([]);
      const [fontFile, setFontFile] = useState(null);
      const customFontNameRef = useRef("CustomFont");

      const pushLog = useCallback(msg => setLog(prev => [msg, ...prev].slice(0, 200)), []);

      const onPickFiles = useCallback(e => {
        const f = Array.from(e.target.files || []);
        setFiles(prev => [...prev, ...f]);
      }, []);

      const onDrop = useCallback(e => {
        e.preventDefault();
        const f = Array.from(e.dataTransfer.files || []);
        setFiles(prev => [...prev, ...f]);
      }, []);

      const prevent = useCallback(e => e.preventDefault(), []);

      const removeFile = idx => setFiles(prev => prev.filter((_, i) => i !== idx));
      const clearFiles = () => setFiles([]);
      const clearConverted = () => { setConverted([]); setMergeList([]); };

      async function ensureCustomFont(pdf) {
        if (!fontFile) return;
        try {
          const buf = await fontFile.arrayBuffer();
          const b64 = bytesToBase64(new Uint8Array(buf));
          const vfsName = fontFile.name || "custom.ttf";
          pdf.addFileToVFS(vfsName, b64);
          const fontName = customFontNameRef.current || "CustomFont";
          pdf.addFont(vfsName, fontName, "normal");
          pdf.setFont(fontName, "normal");
        } catch (e) {
          pushLog(\`‡∏ù‡∏±‡∏á‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: \${e?.message || e}\`);
        }
      }

      async function imageFileToPdf(file) {
        const dataUrl = await new Promise((res, rej) => {
          const fr = new FileReader();
          fr.onload = () => res(fr.result);
          fr.onerror = rej;
          fr.readAsDataURL(file);
        });
        return await new Promise((res, rej) => {
          const img = new Image();
          img.onload = async () => {
            const landscape = img.width >= img.height;
            const pdf = new jsPDF({ orientation: landscape ? "l" : "p", unit: "pt", format: "a4" });
            await ensureCustomFont(pdf);
            const margin = 36;
            const pageW = pdf.internal.pageSize.getWidth();
            const pageH = pdf.internal.pageSize.getHeight();
            const scale = Math.min((pageW - margin * 2) / img.width, (pageH - margin * 2) / img.height);
            const w = img.width * scale;
            const h = img.height * scale;
            const x = (pageW - w) / 2;
            const y = (pageH - h) / 2;
            pdf.addImage(dataUrl, file.type.includes("png") ? "PNG" : "JPEG", x, y, w, h);
            const blob = pdf.output("blob");
            res({ name: file.name.replace(/\.[^.]+$/, "") + ".pdf", blob, size: blob.size });
          };
          img.onerror = rej;
          img.src = dataUrl;
        });
      }

      async function textFileToPdf(file) {
        const text = await file.text();
        const pdf = new jsPDF({ unit: "pt", format: "a4" });
        await ensureCustomFont(pdf);
        const marginX = 40; const marginY = 56; const line = 18; const fontSize = 12;
        pdf.setFontSize(fontSize);
        const pageW = pdf.internal.pageSize.getWidth();
        const pageH = pdf.internal.pageSize.getHeight();
        const maxW = pageW - marginX * 2;

        const clean = text
          .replace(/\r\n?/g, "\n")
          .replace(/^# (.*)$/gm, "$1\n".toUpperCase())
          .replace(/^## (.*)$/gm, "$1\n")
          .replace(/^[-*] /gm, "‚Ä¢ ");

        const paragraphs = clean.split(/\n\n+/);
        let y = marginY;
        for (const p of paragraphs) {
          const lines = pdf.splitTextToSize(p, maxW);
          for (const ln of lines) {
            if (y + line > pageH - marginY) { pdf.addPage(); y = marginY; }
            pdf.text(ln, marginX, y);
            y += line;
          }
          y += Math.round(line * 0.5);
          if (y > pageH - marginY) { pdf.addPage(); y = marginY; }
        }

        const blob = pdf.output("blob");
        return { name: file.name.replace(/\.[^.]+$/, "") + ".pdf", blob, size: blob.size };
      }

      async function passthroughPdf(file) {
        const buf = await file.arrayBuffer();
        return { name: file.name, blob: new Blob([buf], { type: "application/pdf" }), size: file.size };
      }

      function detectKind(file) {
        const ext = (file.name.split(".").pop() || "").toLowerCase();
        if (file.type === "application/pdf" || ext === "pdf") return "pdf";
        if (file.type.startsWith("image/") || ["png","jpg","jpeg","webp","bmp"].includes(ext)) return "image";
        if (file.type.startsWith("text/") || ["txt","md","csv","log","html","htm"].includes(ext)) return "text";
        return "unsupported";
      }

      async function convertOne(file) {
        const kind = detectKind(file);
        switch (kind) {
          case "pdf": return await passthroughPdf(file);
          case "image": return await imageFileToPdf(file);
          case "text": return await textFileToPdf(file);
          default:
            throw new Error("‡πÑ‡∏ü‡∏•‡πå‡∏ä‡∏ô‡∏¥‡∏î‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÅ‡∏ö‡∏ö‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå (‡πÄ‡∏ä‡πà‡∏ô DOCX/XLSX/PPTX)");
        }
      }

      async function handleConvertSelected() {
        if (!files.length) { pushLog("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå"); return; }
        setBusy(true);
        try {
          const out = [];
          for (const f of files) {
            try {
              pushLog(\`‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏õ‡∏•‡∏á: \${f.name}\`);
              const r = await convertOne(f);
              out.push(r);
            } catch (e) {
              pushLog(\`‡πÅ‡∏õ‡∏•‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ: \${f.name} ‚Üí \${e?.message || e}\`);
            }
          }
          setConverted(prev => [...prev, ...out]);
          pushLog(\`‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß: ‡πÅ‡∏õ‡∏•‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à \${out.length} ‡πÑ‡∏ü‡∏•‡πå\`);
        } finally {
          setBusy(false);
        }
      }

      function addConvertedToMerge(idx) {
        setMergeList(prev => [...prev, { type: "converted", idx }]);
      }

      function addUploadedPdfToMerge() {
        const items = files
          .map((f, i) => ({ f, i }))
          .filter(x => detectKind(x.f) === "pdf");
        if (!items.length) { pushLog("‡πÑ‡∏°‡πà‡∏°‡∏µ PDF ‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î"); return; }
        setMergeList(prev => [
          ...prev,
          ...items.map(x => ({ type: "uploaded", fileIndex: x.i }))
        ]);
      }

      function removeFromMerge(i) {
        setMergeList(prev => prev.filter((_, idx) => idx !== i));
      }

      function moveMerge(i, dir) {
        setMergeList(prev => {
          const arr = prev.slice();
          const j = i + dir;
          if (j < 0 || j >= arr.length) return prev;
          const tmp = arr[i]; arr[i] = arr[j]; arr[j] = tmp;
          return arr;
        });
      }

      async function buildMergePdf() {
        if (!mergeList.length) { pushLog("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏ß‡∏°"); return; }
        setBusy(true);
        try {
          const out = await PDFDocument.create();
          for (const item of mergeList) {
            let srcBytes;
            if (item.type === "converted") {
              const obj = converted[item.idx];
              srcBytes = new Uint8Array(await obj.blob.arrayBuffer());
            } else if (item.type === "uploaded") {
              const f = files[item.fileIndex];
              srcBytes = new Uint8Array(await f.arrayBuffer());
            }
            const src = await PDFDocument.load(srcBytes);
            const pages = await out.copyPages(src, src.getPageIndices());
            pages.forEach(p => out.addPage(p));
          }
          const bytes = await out.save();
          const blob = new Blob([bytes], { type: "application/pdf" });
          downloadBlob(blob, \`merged_\${Date.now()}.pdf\`);
          pushLog("‡∏£‡∏ß‡∏° PDF ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
        } catch (e) {
          pushLog(\`‡∏£‡∏ß‡∏°‡πÑ‡∏ü‡∏•‡πå‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: \${e?.message || e}\`);
        } finally {
          setBusy(false);
        }
      }

      const unsupportedList = useMemo(() => files.filter(f => detectKind(f) === "unsupported"), [files]);

      return (
        React.createElement("div", { className: "min-h-screen w-full" },
          React.createElement("div", { className: "mx-auto max-w-6xl px-4 py-8" },
            React.createElement("header", { className: "mb-6" },
              React.createElement("h1", { className: "text-2xl sm:text-3xl font-bold tracking-tight" }, "‡∏ï‡∏±‡∏ß‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏õ‡∏•‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏õ‡πá‡∏ô PDF + ‡∏£‡∏ß‡∏° PDF"),
              React.createElement("p", { className: "text-sm text-slate-600 mt-1" }, "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå")
            ),
            React.createElement("section", { className: "grid lg:grid-cols-3 gap-6 mb-8" },
              React.createElement("div", { className: "lg:col-span-2" },
                React.createElement("div", {
                  onDragOver: prevent, onDragEnter: prevent, onDrop: onDrop,
                  className: "border-2 border-dashed border-slate-300 rounded-2xl p-6 bg-white shadow-sm"
                },
                  React.createElement("p", { className: "font-medium" }, "‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå"),
                  React.createElement("p", { className: "text-xs text-slate-500" }, "‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö: PDF, ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (PNG/JPG/WEBP), ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (TXT/MD/CSV/LOG/HTML ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤)"),
                  React.createElement("div", { className: "mt-4 flex items-center gap-3" },
                    React.createElement("input", { id: "file", type: "file", multiple: true, accept: ACCEPT, onChange: onPickFiles,
                      className: "block w-full text-sm text-slate-700 file:mr-4 file:py-2 file:px-3 file:rounded-xl file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100" }),
                    React.createElement("button", { onClick: clearFiles, className: "px-3 py-2 text-sm rounded-xl bg-slate-100 hover:bg-slate-200" }, "‡∏•‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£")
                  ),
                  unsupportedList.length > 0 && React.createElement("div", { className: "mt-3 text-amber-700 bg-amber-50 border border-amber-200 rounded-xl p-3 text-sm" },
                    "‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÅ‡∏ö‡∏ö‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå: ",
                    unsupportedList.map(f => f.name).join(", "),
                    ".\n‡πÑ‡∏ü‡∏•‡πå‡∏ï‡∏£‡∏∞‡∏Å‡∏π‡∏•‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (DOCX/XLSX/PPTX) ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ù‡∏±‡πà‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô PDF ‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏°‡∏≤‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏∞/‡∏Ñ‡∏£‡∏±‡∏ö"
                  )
                ),
                React.createElement("div", { className: "mt-4 bg-white border rounded-2xl shadow-sm" },
                  React.createElement("div", { className: "px-4 py-2 border-b flex items-center justify-between" },
                    React.createElement("h2", { className: "font-semibold" }, \`‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (\${files.length})\`),
                    React.createElement("div", { className: "flex gap-2" },
                      React.createElement("button", { onClick: handleConvertSelected, disabled: busy || files.length === 0,
                        className: "px-3 py-2 text-sm rounded-xl bg-indigo-600 text-white disabled:opacity-40" }, "‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô PDF"),
                      React.createElement("button", { onClick: addUploadedPdfToMerge, disabled: busy,
                        className: "px-3 py-2 text-sm rounded-xl bg-emerald-600 text-white disabled:opacity-40" }, "‡πÄ‡∏û‡∏¥‡πà‡∏° PDF ‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏Ç‡πâ‡∏≤ Merge")
                    )
                  ),
                  React.createElement("ul", { className: "divide-y max-h-60 overflow-auto" },
                    files.length === 0
                      ? React.createElement("li", { className: "px-4 py-8 text-center text-slate-400 text-sm" }, "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå")
                      : files.map((f, i) => React.createElement("li", { key: i, className: "px-4 py-2 flex items-center justify-between" },
                          React.createElement("div", null,
                            React.createElement("div", { className: "font-medium" }, f.name),
                            React.createElement("div", { className: "text-xs text-slate-500" }, (f.type || "unknown") + " ‚Ä¢ " + niceBytes(f.size))
                          ),
                          React.createElement("div", { className: "flex items-center gap-2" },
                            React.createElement("span", { className: "text-[10px] px-2 py-1 rounded-full bg-slate-100" }, detectKind(f)),
                            React.createElement("button", { onClick: () => removeFile(i), className: "px-2 py-1 text-xs rounded-lg bg-slate-100 hover:bg-slate-200" }, "‡∏•‡∏ö")
                          )
                        ))
                  )
                ),
                React.createElement("div", { className: "mt-4 bg-white border rounded-2xl shadow-sm p-4" },
                  React.createElement("div", { className: "flex items-center justify-between gap-3 flex-wrap" },
                    React.createElement("div", null,
                      React.createElement("div", { className: "font-semibold" }, "‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ (‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å)"),
                      React.createElement("p", { className: "text-xs text-slate-500" }, "‡∏´‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏µ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏ü‡∏≠‡∏ô‡∏ï‡πå .ttf ‡∏´‡∏£‡∏∑‡∏≠ .otf ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ PDF ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á")
                    ),
                    React.createElement("div", { className: "flex items-center gap-2" },
                      React.createElement("input", { type: "file", accept: ".ttf,.otf", onChange: e => setFontFile(e.target.files?.[0] || null) })
                    )
                  ),
                  fontFile && React.createElement("div", { className: "mt-2 text-xs text-slate-600" }, "‡πÉ‡∏ä‡πâ‡∏ü‡∏≠‡∏ô‡∏ï‡πå: ",
                    React.createElement("span", { className: "font-medium" }, fontFile.name)
                  )
                )
              ),
              React.createElement("div", { className: "space-y-6" },
                React.createElement("div", { className: "bg-white border rounded-2xl shadow-sm" },
                  React.createElement("div", { className: "px-4 py-2 border-b flex items-center justify-between" },
                    React.createElement("h2", { className: "font-semibold" }, \`‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à (\${converted.length})\`),
                    React.createElement("button", { onClick: clearConverted, className: "px-3 py-2 text-sm rounded-xl bg-slate-100 hover:bg-slate-200" }, "‡∏•‡πâ‡∏≤‡∏á")
                  ),
                  React.createElement("ul", { className: "divide-y max-h-64 overflow-auto" },
                    converted.length === 0
                      ? React.createElement("li", { className: "px-4 py-8 text-center text-slate-400 text-sm" }, "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á")
                      : converted.map((c, i) => React.createElement("li", { key: i, className: "px-4 py-2 flex items-center justify-between" },
                          React.createElement("div", null,
                            React.createElement("div", { className: "font-medium" }, c.name),
                            React.createElement("div", { className: "text-xs text-slate-500" }, niceBytes(c.size))
                          ),
                          React.createElement("div", { className: "flex items-center gap-2" },
                            React.createElement("button", { onClick: () => downloadBlob(c.blob, c.name), className: "px-2 py-1 text-xs rounded-lg bg-slate-100 hover:bg-slate-200" }, "‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î"),
                            React.createElement("button", { onClick: () => addConvertedToMerge(i), className: "px-2 py-1 text-xs rounded-lg bg-emerald-600 text-white" }, "‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤ Merge")
                          )
                        ))
                  )
                ),
                React.createElement("div", { className: "bg-white border rounded-2xl shadow-sm" },
                  React.createElement("div", { className: "px-4 py-2 border-b flex items-center justify-between" },
                    React.createElement("h2", { className: "font-semibold" }, \`‡∏Ñ‡∏¥‡∏ß‡∏£‡∏ß‡∏° PDF (\${mergeList.length})\`),
                    React.createElement("button", { onClick: buildMergePdf, disabled: busy || mergeList.length === 0,
                      className: "px-3 py-2 text-sm rounded-xl bg-emerald-600 text-white disabled:opacity-40" }, "‡∏£‡∏ß‡∏°‡πÅ‡∏•‡∏∞‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î")
                  ),
                  React.createElement("ul", { className: "divide-y max-h-64 overflow-auto" },
                    mergeList.length === 0
                      ? React.createElement("li", { className: "px-4 py-8 text-center text-slate-400 text-sm" }, "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡∏Ñ‡∏¥‡∏ß‡∏£‡∏ß‡∏°")
                      : mergeList.map((m, i) => {
                          let label = "";
                          if (m.type === "converted") label = converted[m.idx]?.name || "[‡πÅ‡∏õ‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏≤‡∏¢]";
                          else if (m.type === "uploaded") label = files[m.fileIndex]?.name || "[‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏≤‡∏¢]";
                          return React.createElement("li", { key: i, className: "px-4 py-2 flex items-center justify-between" },
                            React.createElement("div", null,
                              React.createElement("div", { className: "font-medium" }, label),
                              React.createElement("div", { className: "text-xs text-slate-500" }, m.type)
                            ),
                            React.createElement("div", { className: "flex items-center gap-2" },
                              React.createElement("button", { onClick: () => moveMerge(i, -1), className: "px-2 py-1 text-xs rounded-lg bg-slate-100 hover:bg-slate-200" }, "‡∏Ç‡∏∂‡πâ‡∏ô"),
                              React.createElement("button", { onClick: () => moveMerge(i, 1), className: "px-2 py-1 text-xs rounded-lg bg-slate-100 hover:bg-slate-200" }, "‡∏•‡∏á"),
                              React.createElement("button", { onClick: () => removeFromMerge(i), className: "px-2 py-1 text-xs rounded-lg bg-rose-100 hover:bg-rose-200" }, "‡∏•‡∏ö")
                            )
                          );
                        })
                  )
                ),
                React.createElement("div", { className: "bg-white border rounded-2xl shadow-sm p-4 text-xs text-slate-600" },
                  React.createElement("div", { className: "font-semibold mb-1" }, "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞"),
                  React.createElement("ul", { className: "space-y-1 max-h-40 overflow-auto" },
                    log.length === 0
                      ? React.createElement("li", { className: "text-slate-400" }, "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°")
                      : log.map((l, i) => React.createElement("li", { key: i, className: "leading-4" }, "‚Ä¢ ", l))
                  )
                )
              )
            ),
            React.createElement("section", { className: "mt-4 text-xs text-slate-500 space-y-2" },
              React.createElement("p", null, "‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ï‡∏£‡∏∞‡∏Å‡∏π‡∏•‡∏≠‡∏≠‡∏ü‡∏ü‡∏¥‡∏® (DOCX/XLSX/PPTX) ‡πÉ‡∏´‡πâ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô PDF ‡∏à‡∏≤‡∏Å‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏ù‡∏±‡πà‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏≥‡πÑ‡∏õ‡πÅ‡∏õ‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ"),
              React.createElement("details", { className: "bg-slate-100 rounded-xl p-3" },
                React.createElement("summary", { className: "cursor-pointer font-medium" }, "‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏ù‡∏±‡πà‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏õ‡∏•‡∏á DOCX/XLSX/PPTX ‚Üí PDF"),
                React.createElement("pre", { className: "mt-2 whitespace-pre-wrap text-[10px]" }, `# ‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡∏¢‡πà‡∏≠: ‡πÉ‡∏ä‡πâ LibreOffice (soffice) ‡πÉ‡∏ô Docker ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏õ‡∏•‡∏á ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏´‡πâ API ‡∏™‡πà‡∏á‡πÑ‡∏ü‡∏•‡πå PDF ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤
# ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå Node.js ‡∏î‡πâ‡∏ß‡∏¢ child_process (pseudo):

import express from 'express';
import multer from 'multer';
import { execFile } from 'child_process';
import fs from 'fs/promises';

const app = express();
const upload = multer({ dest: 'uploads/' });

app.post('/convert', upload.single('file'), async (req, res) => {
  try {
    const src = req.file.path;
    const outDir = 'converted';
    await fs.mkdir(outDir, { recursive: true });
    await new Promise((resolve, reject) => {
      execFile('soffice', ['--headless','--convert-to','pdf','--outdir', outDir, src], (err) => err ? reject(err) : resolve());
    });
    const outPath = src.replace('uploads', 'converted') + '.pdf'; // ‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏≤‡∏à‡∏≤‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á
    const pdf = await fs.readFile(outPath);
    res.setHeader('Content-Type','application/pdf');
    res.send(pdf);
  } catch(e) { res.status(500).send(String(e)); }
});

app.listen(3000);`)
              )
            )
          )
        )
      );
    }

    const root = createRoot(document.getElementById("root"));
    root.render(React.createElement(App));
  </script>
</body>
</html>
